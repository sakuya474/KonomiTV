import{d as A,am as D,Z as x,x as y,U as T,z,k as M,h as m,aE as k,b as t,c as a,e as p,w as v,a as i,r as R,l as s,ab as B,v as f,V as F,ak as c,M as E,o,R as Q,_ as $}from"./index-26jul5yA.js";import{S as K}from"./Base-B_bk6JJM.js";import{V as S}from"./VSwitch-C5zVEt9N.js";import{c as w,V as L}from"./VSelect-r-so1AtO.js";import{b as g}from"./VTextField-KcbvA6Hy.js";import"./Navigation-BazZrJq3.js";import"./VSpacer-D77fs5_2.js";import"./ssrBoot-D0aHTF31.js";import"./VSelectionControl-DES_kmZi.js";import"./forwardRefs-DboJVnh3.js";import"./dialog-transition-BLjzztn0.js";import"./VOverlay-CQXLzbkN.js";import"./VDivider-DDyHcbCK.js";const Z={class:"settings__heading"},j={key:0,class:"settings__content"},q={class:"settings__content-heading"},J={class:"settings__item settings__item--switch"},O={class:"settings__item"},W={class:"settings__item"},X={class:"settings__item"},Y={class:"settings__item settings__item--switch"},h={class:"settings__item"},ee={class:"settings__content-heading mt-6"},te={class:"settings__item"},le={class:"settings__item-heading"},se={class:"settings__item-label"},ne={key:0,class:"text-orange-500 d-block mt-1"},ie={key:1,class:"text-orange-500 d-block mt-1"},oe={class:"settings__item"},ae={class:"settings__item-heading"},de={class:"settings__item-label"},re={key:0,class:"text-orange-500 d-block mt-1"},ue={key:1,class:"text-orange-500 d-block mt-1"},_e={class:"settings__item"},me={class:"settings__item-heading"},pe={class:"settings__item-label"},ge={key:0,class:"text-orange-500 d-block mt-1"},ve={key:1,class:"text-orange-500 d-block mt-1"},ce={class:"settings__item"},fe={class:"settings__item-heading"},be={class:"settings__item-label"},Ve={key:0,class:"text-orange-500 d-block mt-1"},ye={key:1,class:"text-orange-500 d-block mt-1"},ke={class:"settings__item"},we={class:"settings__item-heading"},Ue={class:"settings__item-label"},Ce={key:0,class:"text-orange-500 d-block mt-1"},xe={key:1,class:"text-orange-500 d-block mt-1"},Ee={class:"settings__item"},Se={class:"settings__item-heading"},Pe={class:"settings__item-label"},He={key:0,class:"text-orange-500 d-block mt-1"},Ge={key:1,class:"text-orange-500 d-block mt-1"},Ie={class:"settings__item"},Ne={class:"settings__item-heading"},Ae={class:"settings__item-label"},De={key:0,class:"text-orange-500 d-block mt-1"},Te={key:1,class:"text-orange-500 d-block mt-1"},ze={class:"settings__item"},Me={class:"settings__item-heading"},Re={class:"settings__item-label"},Be={key:0,class:"text-orange-500 d-block mt-1"},Fe={key:1,class:"text-orange-500 d-block mt-1"},Qe=A({__name:"TSReplaceEncoding",setup($e){const U=D(),l=x(null),V=x(!1);async function P(){const d=await k.fetchServerSettings();l.value=d}async function H(){try{const d=await k.fetchHardwareEncoderStatus();V.value=d.hardware_encoder_available}catch(d){console.error("Failed to check hardware encoder availability:",d),V.value=!1}}const G=y(()=>V.value?[{title:"ソフトウェア (CPU)",value:"software",disabled:!1,key:"software"},{title:"ハードウェア (GPU)",value:"hardware",disabled:!1,key:"hardware"}]:[{title:"ソフトウェア (CPU)",value:"software",disabled:!1,key:"software"},{title:"ハードウェア (GPU)",value:"hardware",disabled:!0,subtitle:"使用できません（対応するGPUが検出されませんでした）",key:"hardware-disabled"}]),u=y(()=>T.isSmartphoneHorizontal()),_=y(()=>U.user===null||U.user.is_admin===!1),r=y(()=>{var d,e;return!((e=(d=l.value)==null?void 0:d.tsreplace_encoding)!=null&&e.auto_encoding_enabled)||_.value});function I(d){return d<1||d>10?"1以上10以下の値を入力してください。":!0}async function N(){if(l.value===null)return;!V.value&&l.value.tsreplace_encoding.auto_encoding_encoder==="hardware"&&(l.value.tsreplace_encoding.auto_encoding_encoder="software",E.warning("ハードウェアエンコーダーが利用できないため、ソフトウェアエンコードに切り替えました。")),await k.updateServerSettings(l.value)===!0&&E.success(`エンコード設定を更新しました。
変更を反映するためには、KonomiTV サーバーを再起動してください。`)}return z(async()=>{await Promise.all([P(),H()])}),(d,e)=>{const b=R("Icon");return o(),M(K,null,{default:m(()=>[t("h2",Z,[v((o(),a("a",{class:"settings__back-button",onClick:e[0]||(e[0]=n=>d.$router.back())},[i(b,{icon:"fluent:chevron-left-12-filled",width:"27px"})])),[[Q]]),i(b,{icon:"fluent:video-clip-wand-16-filled",width:"19px",style:{margin:"0 4px"}}),e[16]||(e[16]=t("span",{class:"ml-3"},"エンコード",-1))]),e[74]||(e[74]=t("div",{class:"settings__description"},[s(" 録画終了時の自動エンコードと録画一覧からの手動再エンコードの設定を行えます。"),t("br"),s(" TSReplaceを使用してH.262-TSからH.264/HEVCへの映像変換を行い、ファイルサイズの削減と互換性の向上を図ります。 ")],-1)),e[75]||(e[75]=t("div",{class:"settings__description"},[s(" サーバー設定を変更するには、管理者アカウントでログインしている必要があります。"),t("br")],-1)),e[76]||(e[76]=t("div",{class:"settings__description mt-1"},[s(" [サーバー設定を更新] ボタンを押さずにこのページから離れると、変更内容は破棄されます。"),t("br"),s(" 変更を反映するには KonomiTV サーバーの再起動が必要です。"),t("br")],-1)),l.value?(o(),a("div",j,[t("div",q,[i(b,{icon:"fluent:settings-16-filled",width:"20px"}),e[17]||(e[17]=t("span",{class:"ml-3"},"基本設定",-1))]),t("div",J,[e[18]||(e[18]=t("label",{class:"settings__item-heading",for:"auto_encoding"},"自動エンコード",-1)),e[19]||(e[19]=t("label",{class:"settings__item-label",for:"auto_encoding"},[s(" 録画終了時に自動的にエンコードを行います。"),t("br")],-1)),i(S,{class:"settings__item-switch",color:"primary",id:"auto_encoding","hide-details":"",modelValue:l.value.tsreplace_encoding.auto_encoding_enabled,"onUpdate:modelValue":e[1]||(e[1]=n=>l.value.tsreplace_encoding.auto_encoding_enabled=n),disabled:_.value},null,8,["modelValue","disabled"])]),t("div",O,[e[20]||(e[20]=t("div",{class:"settings__item-heading"},"エンコードコーデック",-1)),e[21]||(e[21]=t("div",{class:"settings__item-label"},[s(" エンコードに使用するビデオコーデックを選択します。"),t("br"),s(" H.264は高い互換性、H.265(HEVC)はより高い圧縮効率を提供しますが処理時間が長くなります。 ")],-1)),i(w,{class:"settings__item-form",color:"primary",variant:"outlined",items:[{title:"H.264 (AVC)",value:"h264"},{title:"H.265 (HEVC)",value:"hevc"}],density:u.value?"compact":"default",modelValue:l.value.tsreplace_encoding.auto_encoding_codec,"onUpdate:modelValue":e[2]||(e[2]=n=>l.value.tsreplace_encoding.auto_encoding_codec=n),disabled:r.value,"hide-details":""},null,8,["density","modelValue","disabled"])]),t("div",W,[e[22]||(e[22]=t("div",{class:"settings__item-heading"},"エンコーダー種類",-1)),e[23]||(e[23]=t("div",{class:"settings__item-label"},[s(" ソフトウェアエンコードは高品質、ハードウェアエンコードは高速処理が可能です。"),t("br"),s(" ハードウェアエンコードを使用する場合は、対応するGPUが必要です。 ")],-1)),i(w,{class:"settings__item-form",color:"primary",variant:"outlined",items:G.value,modelValue:l.value.tsreplace_encoding.auto_encoding_encoder,"onUpdate:modelValue":e[3]||(e[3]=n=>l.value.tsreplace_encoding.auto_encoding_encoder=n),density:u.value?"compact":"default",disabled:r.value,"hide-details":"","item-title":"title","item-value":"value","item-key":"key"},{item:m(({props:n,item:C})=>[i(L,B(n,{disabled:C.raw.disabled,subtitle:C.raw.subtitle}),null,16,["disabled","subtitle"])]),_:1},8,["items","modelValue","density","disabled"])]),v(t("div",X,[e[24]||(e[24]=t("div",{class:"settings__item-heading"},"ハードウェアエンコーダー種類",-1)),e[25]||(e[25]=t("div",{class:"settings__item-label"},[s(" 使用するGPUエンコーダーの種類を選択します。"),t("br"),s(" お使いのGPUに対応したエンコーダーを選択してください。 ")],-1)),i(w,{class:"settings__item-form",color:"primary",variant:"outlined",items:[{title:"NVEncC : NVIDIA GPU で利用可能",value:"nvidia"},{title:"VCEEncC : AMD GPU で利用可能",value:"amd"},{title:"QSVEncC : Intel Graphics 搭載 CPU / Intel Arc GPU で利用可能",value:"intel"}],density:u.value?"compact":"default",modelValue:l.value.tsreplace_encoding.hardware_encoder_type,"onUpdate:modelValue":e[4]||(e[4]=n=>l.value.tsreplace_encoding.hardware_encoder_type=n),disabled:r.value,"hide-details":""},null,8,["density","modelValue","disabled"])],512),[[f,l.value.tsreplace_encoding.auto_encoding_encoder==="hardware"]]),t("div",Y,[e[26]||(e[26]=t("label",{class:"settings__item-heading"},"エンコード完了後に元ファイルを削除",-1)),e[27]||(e[27]=t("label",{class:"settings__item-label",for:"delete_original_after_encoding"},[s(" エンコード完了後に元のTSファイルを自動的に削除します。"),t("br"),s(" ストレージ容量の節約になりますが、元ファイルは復元できないため注意してください。 ")],-1)),i(S,{class:"settings__item-switch",color:"primary",id:"delete_original_after_encoding","hide-details":"",modelValue:l.value.tsreplace_encoding.delete_original_after_encoding,"onUpdate:modelValue":e[5]||(e[5]=n=>l.value.tsreplace_encoding.delete_original_after_encoding=n),disabled:r.value},null,8,["modelValue","disabled"])]),t("div",h,[e[28]||(e[28]=t("div",{class:"settings__item-heading"},"最大同時エンコード数",-1)),e[29]||(e[29]=t("div",{class:"settings__item-label"},[s(" 同時に実行できるエンコード処理の最大数を設定します。"),t("br"),s(" 値を大きくするとより多くのファイルを並行処理できますが、システムリソースを多く消費します。 ")],-1)),i(g,{class:"settings__item-form",color:"primary",variant:"outlined",density:u.value?"compact":"default",type:"number",min:"1",max:"10",rules:[I],modelValue:l.value.tsreplace_encoding.max_concurrent_encodings,"onUpdate:modelValue":e[6]||(e[6]=n=>l.value.tsreplace_encoding.max_concurrent_encodings=n),modelModifiers:{number:!0},disabled:r.value},null,8,["density","rules","modelValue","disabled"])]),i(F,{class:"settings__save-button bg-secondary mt-6",variant:"flat",disabled:_.value,onClick:e[7]||(e[7]=n=>N())},{default:m(()=>[i(b,{icon:"fluent:save-16-filled",class:"mr-2",height:"23px"}),e[30]||(e[30]=s("エンコード設定を更新 ",-1))]),_:1},8,["disabled"]),t("div",ee,[i(b,{icon:"fluent:developer-board-16-filled",width:"20px"}),e[31]||(e[31]=t("span",{class:"ml-2"},"コマンドラインオプション",-1))]),e[73]||(e[73]=t("div",{class:"settings__description"},[s(" 高度なエンコーディング設定です。よくわからない場合はそのままにしてください。"),t("br")],-1)),t("div",te,[t("div",le,[e[33]||(e[33]=s(" ソフトウェアエンコード (CPU) H.264 オプション ",-1)),i(c,{size:"small",color:"blue-darken-1",variant:"outlined",class:"ml-2"},{default:m(()=>[...e[32]||(e[32]=[t("span",null,"libx264",-1)])]),_:1})]),t("div",se,[e[35]||(e[35]=s(" TSReplace経由でFFmpegのlibx264エンコーダーを使用します。高い互換性を持ちます。",-1)),e[36]||(e[36]=t("br",null,null,-1)),r.value?(o(),a("span",ne)):_.value?(o(),a("span",ie,[...e[34]||(e[34]=[t("strong",null,"※ この設定の変更には管理者権限が必要です。",-1)])])):p("",!0)]),i(g,{class:"settings__item-form",color:"primary",variant:"outlined",density:u.value?"compact":"default",modelValue:l.value.tsreplace_encoding.ffmpeg_h264_options,"onUpdate:modelValue":e[8]||(e[8]=n=>l.value.tsreplace_encoding.ffmpeg_h264_options=n),"prepend-inner-icon":"fluent:code-16-filled","hide-details":""},null,8,["density","modelValue"])]),t("div",oe,[t("div",ae,[e[38]||(e[38]=s(" ソフトウェアエンコード (CPU) H.265 オプション ",-1)),i(c,{size:"small",color:"purple-darken-1",variant:"outlined",class:"ml-2"},{default:m(()=>[...e[37]||(e[37]=[t("span",null,"libx265",-1)])]),_:1})]),t("div",de,[e[40]||(e[40]=s(" TSReplace経由でFFmpegのlibx265エンコーダーを使用します。H.264より高い圧縮効率を持ちますが、エンコード時間が長くなります。",-1)),e[41]||(e[41]=t("br",null,null,-1)),r.value?(o(),a("span",re)):_.value?(o(),a("span",ue,[...e[39]||(e[39]=[t("strong",null,"※ この設定の変更には管理者権限が必要です。",-1)])])):p("",!0)]),i(g,{class:"settings__item-form",color:"primary",variant:"outlined",density:u.value?"compact":"default",modelValue:l.value.tsreplace_encoding.ffmpeg_hevc_options,"onUpdate:modelValue":e[9]||(e[9]=n=>l.value.tsreplace_encoding.ffmpeg_hevc_options=n),"prepend-inner-icon":"fluent:code-16-filled","hide-details":""},null,8,["density","modelValue"])]),v(t("div",_e,[t("div",me,[e[43]||(e[43]=s(" NVIDIA GPU H.264 エンコードオプション ",-1)),i(c,{size:"small",color:"green-darken-1",variant:"outlined",class:"ml-2"},{default:m(()=>[...e[42]||(e[42]=[t("span",null,"NVEncC",-1)])]),_:1})]),t("div",pe,[e[45]||(e[45]=s(" NVIDIA GPU使用時のH.264エンコード設定です（NVEncC経由）。",-1)),e[46]||(e[46]=t("br",null,null,-1)),r.value?(o(),a("span",ge)):_.value?(o(),a("span",ve,[...e[44]||(e[44]=[t("strong",null,"※ この設定の変更には管理者権限が必要です。",-1)])])):p("",!0)]),i(g,{class:"settings__item-form",color:"primary",variant:"outlined",density:u.value?"compact":"default",modelValue:l.value.tsreplace_encoding.nvidia_h264_options,"onUpdate:modelValue":e[10]||(e[10]=n=>l.value.tsreplace_encoding.nvidia_h264_options=n),"prepend-inner-icon":"fluent:code-16-filled","hide-details":""},null,8,["density","modelValue"])],512),[[f,l.value.tsreplace_encoding.hardware_encoder_type==="nvidia"]]),v(t("div",ce,[t("div",fe,[e[48]||(e[48]=s(" NVIDIA GPU H.265 エンコードオプション ",-1)),i(c,{size:"small",color:"green-darken-2",variant:"outlined",class:"ml-2"},{default:m(()=>[...e[47]||(e[47]=[t("span",null,"NVEncC",-1)])]),_:1})]),t("div",be,[e[50]||(e[50]=s(" NVIDIA GPU使用時のH.265エンコード設定です（NVEncC経由）。",-1)),e[51]||(e[51]=t("br",null,null,-1)),r.value?(o(),a("span",Ve)):_.value?(o(),a("span",ye,[...e[49]||(e[49]=[t("strong",null,"※ この設定の変更には管理者権限が必要です。",-1)])])):p("",!0)]),i(g,{class:"settings__item-form",color:"primary",variant:"outlined",density:u.value?"compact":"default",modelValue:l.value.tsreplace_encoding.nvidia_hevc_options,"onUpdate:modelValue":e[11]||(e[11]=n=>l.value.tsreplace_encoding.nvidia_hevc_options=n),"prepend-inner-icon":"fluent:code-16-filled","hide-details":""},null,8,["density","modelValue"])],512),[[f,l.value.tsreplace_encoding.hardware_encoder_type==="nvidia"]]),v(t("div",ke,[t("div",we,[e[53]||(e[53]=s(" AMD GPU H.264 エンコードオプション ",-1)),i(c,{size:"small",color:"red-darken-1",variant:"outlined",class:"ml-2"},{default:m(()=>[...e[52]||(e[52]=[t("span",null,"VCEEncC",-1)])]),_:1})]),t("div",Ue,[e[55]||(e[55]=s(" AMD GPU使用時のH.264エンコード設定です（VCEEncC経由）。",-1)),e[56]||(e[56]=t("br",null,null,-1)),r.value?(o(),a("span",Ce)):_.value?(o(),a("span",xe,[...e[54]||(e[54]=[t("strong",null,"※ この設定の変更には管理者権限が必要です。",-1)])])):p("",!0)]),i(g,{class:"settings__item-form",color:"primary",variant:"outlined",density:u.value?"compact":"default",modelValue:l.value.tsreplace_encoding.amd_h264_options,"onUpdate:modelValue":e[12]||(e[12]=n=>l.value.tsreplace_encoding.amd_h264_options=n),"prepend-inner-icon":"fluent:code-16-filled","hide-details":""},null,8,["density","modelValue"])],512),[[f,l.value.tsreplace_encoding.hardware_encoder_type==="amd"]]),v(t("div",Ee,[t("div",Se,[e[58]||(e[58]=s(" AMD GPU H.265 エンコードオプション ",-1)),i(c,{size:"small",color:"red-darken-2",variant:"outlined",class:"ml-2"},{default:m(()=>[...e[57]||(e[57]=[t("span",null,"VCEEncC",-1)])]),_:1})]),t("div",Pe,[e[60]||(e[60]=s(" AMD GPU使用時のH.265エンコード設定です（VCEEncC経由）。",-1)),e[61]||(e[61]=t("br",null,null,-1)),r.value?(o(),a("span",He)):_.value?(o(),a("span",Ge,[...e[59]||(e[59]=[t("strong",null,"※ この設定の変更には管理者権限が必要です。",-1)])])):p("",!0)]),i(g,{class:"settings__item-form",color:"primary",variant:"outlined",density:u.value?"compact":"default",modelValue:l.value.tsreplace_encoding.amd_hevc_options,"onUpdate:modelValue":e[13]||(e[13]=n=>l.value.tsreplace_encoding.amd_hevc_options=n),"prepend-inner-icon":"fluent:code-16-filled","hide-details":""},null,8,["density","modelValue"])],512),[[f,l.value.tsreplace_encoding.hardware_encoder_type==="amd"]]),v(t("div",Ie,[t("div",Ne,[e[63]||(e[63]=s(" Intel GPU H.264 エンコードオプション ",-1)),i(c,{size:"small",color:"blue-darken-1",variant:"outlined",class:"ml-2"},{default:m(()=>[...e[62]||(e[62]=[t("span",null,"QSVEncC",-1)])]),_:1})]),t("div",Ae,[e[65]||(e[65]=s(" Intel GPU使用時のH.264エンコード設定です（QSVEncC経由）。",-1)),e[66]||(e[66]=t("br",null,null,-1)),r.value?(o(),a("span",De)):_.value?(o(),a("span",Te,[...e[64]||(e[64]=[t("strong",null,"※ この設定の変更には管理者権限が必要です。",-1)])])):p("",!0)]),i(g,{class:"settings__item-form",color:"primary",variant:"outlined",density:u.value?"compact":"default",modelValue:l.value.tsreplace_encoding.intel_h264_options,"onUpdate:modelValue":e[14]||(e[14]=n=>l.value.tsreplace_encoding.intel_h264_options=n),"prepend-inner-icon":"fluent:code-16-filled","hide-details":""},null,8,["density","modelValue"])],512),[[f,l.value.tsreplace_encoding.hardware_encoder_type==="intel"]]),v(t("div",ze,[t("div",Me,[e[68]||(e[68]=s(" Intel GPU H.265 エンコードオプション ",-1)),i(c,{size:"small",color:"blue-darken-2",variant:"outlined",class:"ml-2"},{default:m(()=>[...e[67]||(e[67]=[t("span",null,"QSVEncC",-1)])]),_:1})]),t("div",Re,[e[71]||(e[71]=s(" Intel GPU使用時のH.265エンコード設定です（QSVEncC経由）。",-1)),e[72]||(e[72]=t("br",null,null,-1)),r.value?(o(),a("span",Be,[...e[69]||(e[69]=[t("strong",null,"※ この設定は自動エンコードが有効な場合のみ変更可能です。",-1)])])):_.value?(o(),a("span",Fe,[...e[70]||(e[70]=[t("strong",null,"※ この設定の変更には管理者権限が必要です。",-1)])])):p("",!0)]),i(g,{class:"settings__item-form",color:"primary",variant:"outlined",density:u.value?"compact":"default",modelValue:l.value.tsreplace_encoding.intel_hevc_options,"onUpdate:modelValue":e[15]||(e[15]=n=>l.value.tsreplace_encoding.intel_hevc_options=n),"prepend-inner-icon":"fluent:code-16-filled","hide-details":""},null,8,["density","modelValue"])],512),[[f,l.value.tsreplace_encoding.hardware_encoder_type==="intel"]])])):p("",!0)]),_:1})}}}),lt=$(Qe,[["__scopeId","data-v-af436c9d"]]);export{lt as default};
