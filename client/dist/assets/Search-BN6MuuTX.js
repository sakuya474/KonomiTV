import{d as w,X as C,y as L,aj as M,z as V,q as S,c as b,a as i,b as e,k as c,t as p,h as d,ah as q,l as D,F as x,g as $,af as h,V as _,p as v,M as u,o,_ as I}from"./index-l7mZcvr7.js";import{H as N,N as T}from"./Navigation-B9tp9jHO.js";import{S as z}from"./SPHeaderBar-CN-stF4Y.js";import{B as F}from"./Breadcrumbs-BZFuG6O5.js";import{u as E}from"./BDLibraryStore-D2pBirDb.js";import{u as H}from"./BDLibraryMylistStore-DIlLO2aH.js";import{V as P,a as R}from"./VRow-B1rb2uxW.js";import{V as j,d as X}from"./VCard-DoCWD6u_.js";import"./VSpacer-DdZJeH7L.js";import"./ssrBoot-zDIWP7Ii.js";import"./BDLibrary-CgdH6yrr.js";import"./VAvatar-mOFXakeW.js";import"./transition-DqJDDmP2.js";const A={class:"route-container"},G={class:"bd-library-search-container-wrapper"},J={class:"bd-library-search-container"},K={class:"bd-library-header"},O={class:"search-results-count"},Q={key:0,class:"bd-library-empty"},U={class:"bd-directory-thumb-img-wrapper"},W=["src"],Y={class:"bd-directory-thumb-title-text"},Z=w({__name:"Search",setup(tt){const f=E(),a=H(),m=M(),l=C("");L(async()=>{await Promise.all([f.fetchBDLibraryList(1),a.fetchMylistItems()]),m.query.query&&(l.value=m.query.query)}),V(()=>m.query.query,r=>{r&&(l.value=r)});const y=S(()=>{if(!l.value.trim())return[];const r=l.value.toLowerCase();return f.bdList.filter(s=>s.title.toLowerCase().includes(r)||s.path.toLowerCase().includes(r))});function g(r){const t=r.target;t.src="/assets/images/icon.svg"}const k=async r=>{try{await a.addToMylist(r),u.success("マイリストに追加しました。")}catch{u.error("BDマイリストの追加に失敗しました。ログインし直してください。")}},B=async r=>{try{const t=a.mylist_items.find(s=>s.bd_id===r);t&&(await a.removeFromMylist(t.id),u.show("マイリストから削除しました。"))}catch{u.error("BDマイリストの削除に失敗しました。ログインし直してください。")}};return(r,t)=>(o(),b("div",A,[i(N),e("main",null,[i(T),e("div",G,[i(z),i(F,{crumbs:[{name:"BDライブラリ",path:"/bd-library/"},{name:"検索結果",path:"/bd-library/search",disabled:!0}]}),e("div",J,[e("div",K,[e("h2",null,"「"+p(l.value)+"」の検索結果",1),e("p",O,"検索結果: "+p(y.value.length)+"件",1)]),y.value.length===0?(o(),b("div",Q,[i(q,{size:"48",color:"grey"},{default:d(()=>[...t[1]||(t[1]=[D("mdi-alert-circle-outline",-1)])]),_:1}),t[2]||(t[2]=e("div",{class:"bd-library-empty-title"}," 検索結果が見つかりませんでした。 ",-1)),t[3]||(t[3]=e("div",{class:"bd-library-empty-desc"}," 別のキーワードで検索してみてください。 ",-1))])):(o(),c(P,{key:1},{default:d(()=>[(o(!0),b(x,null,$(y.value,s=>(o(),c(R,{key:s.id,cols:"12",sm:"6",md:"4",lg:"3"},{default:d(()=>[i(X,{class:"bd-directory-thumb-card",border:"",onClick:n=>r.$router.push(`/bd-library/watch/${s.id}`)},{default:d(()=>[e("div",U,[e("img",{class:"bd-directory-thumb-img",src:`/api/bd-library/${s.id}/thumbnail`,alt:"サムネイル",onError:t[0]||(t[0]=n=>g(n))},null,40,W)]),i(j,{class:"bd-directory-thumb-title"},{default:d(()=>[e("span",Y,p(s.title),1),h(a).isInMylist(s.id)?(o(),c(_,{key:1,icon:"mdi-check",size:"small",variant:"text",color:"pink",class:"bd-directory-thumb-mylist-btn",onClick:v(n=>B(s.id),["stop"]),loading:h(a).is_loading},null,8,["onClick","loading"])):(o(),c(_,{key:0,icon:"mdi-plus",size:"small",variant:"text",color:"white",class:"bd-directory-thumb-mylist-btn",onClick:v(n=>k(s),["stop"]),loading:h(a).is_loading},null,8,["onClick","loading"]))]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}))])])])]))}}),bt=I(Z,[["__scopeId","data-v-190c247b"]]);export{bt as default};
