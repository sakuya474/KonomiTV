import{d as E,Q as R,X as C,q,z as L,c as d,F as M,b as t,e as u,a as l,n as h,af as g,k as w,V as f,h as n,t as p,ao as Y,U as z,p as H,M as $,ah as b,l as T,r as A,o as r,_ as S,g as Q}from"./index-PPs0Ssvj.js";import{C as X}from"./Captures-C5KjY8Tm.js";import{V as I}from"./VSpacer-DWKeWgTX.js";import{V as D}from"./VAvatar-D79LN0fb.js";import{V as G}from"./VDialog-B3GmWX_E.js";import{d as F,V as N,b as J,c as K}from"./VCard-BetW2VVL.js";const O={class:"capture-detail-drawer__header"},P={key:1,class:"capture-detail-drawer__content"},W={class:"capture-detail-drawer__property"},Z={class:"capture-detail-drawer__property-value"},ee={key:0,class:"capture-detail-drawer__property"},te={class:"capture-detail-drawer__property-value"},ae={key:1,class:"capture-detail-drawer__property"},le={class:"capture-detail-drawer__property-value"},se={class:"capture-detail-drawer__property"},re={class:"capture-detail-drawer__property-value"},ie={class:"capture-detail-drawer__property"},ne={class:"capture-detail-drawer__property-value-container"},oe={class:"capture-detail-drawer__property-value capture-detail-drawer__property-value--path"},de={class:"capture-detail-drawer__footer"},ue=["src"],ce={key:0,class:"mb-4 text-center"},pe={class:"text-h7 text-text mb-2"},me={class:"warning-banner warning-banner--normal"},ve=E({__name:"CaptureDetailDrawer",props:{capture:{},modelValue:{type:Boolean}},emits:["update:modelValue","delete"],setup(a,{emit:_}){const o=a,x=_,m=R(),s=C(!1),v=q({get:()=>o.modelValue,set:c=>x("update:modelValue",c)});L(v,c=>{c?document.documentElement.classList.add("v-overlay-scroll-blocked"):s.value===!1&&document.documentElement.classList.remove("v-overlay-scroll-blocked")}),L(s,c=>{c?document.documentElement.classList.add("v-overlay-scroll-blocked"):v.value===!1&&document.documentElement.classList.remove("v-overlay-scroll-blocked")});const i=()=>{v.value=!1},B=async()=>{if(o.capture)try{const c=await fetch(o.capture.url);if(!c.ok)throw new Error("Failed to fetch capture image.");const e=await c.blob();z.downloadBlobData(e,o.capture.name),$.success("キャプチャをダウンロードしました。")}catch(c){console.error("Failed to download capture:",c),$.error("キャプチャのダウンロードに失敗しました。")}},k=C(!1),U=async()=>{o.capture&&(k.value=!0)},j=async()=>{if(!o.capture)return;k.value=!1,await X.deleteCapture(o.capture.name)&&($.success("キャプチャを削除しました。"),x("delete"),i())};return(c,e)=>{const V=A("Icon");return r(),d(M,null,[t("div",{class:h(["capture-detail-drawer__scrim",{"capture-detail-drawer__scrim--visible":v.value}]),onClick:i},null,2),t("div",{class:h(["capture-detail-drawer",{"capture-detail-drawer--visible":v.value,"capture-detail-drawer--bottom-sheet":g(m).smAndDown.value}])},[t("div",O,[e[7]||(e[7]=t("div",{class:"capture-detail-drawer__title"},"キャプチャ情報",-1)),l(I),l(f,{icon:"",variant:"flat",onClick:i},{default:n(()=>[l(b,{icon:"mdi-close"})]),_:1})]),a.capture&&g(m).smAndDown.value?(r(),w(D,{key:0,src:a.capture.url,"aspect-ratio":"1.7778",class:"capture-detail-drawer__image"},null,8,["src"])):u("",!0),a.capture?(r(),d("div",P,[t("div",W,[e[8]||(e[8]=t("div",{class:"capture-detail-drawer__property-label"},"ファイル名",-1)),t("div",Z,p(a.capture.name),1)]),a.capture.time?(r(),d("div",ee,[e[9]||(e[9]=t("div",{class:"capture-detail-drawer__property-label"},"時間",-1)),t("div",te,p(g(Y)(a.capture.time).format("YYYY/MM/DD HH:mm:ss")),1)])):u("",!0),a.capture.program_title?(r(),d("div",ae,[e[10]||(e[10]=t("div",{class:"capture-detail-drawer__property-label"},"番組",-1)),t("div",le,p(a.capture.channel_name)+" - "+p(a.capture.program_title),1)])):u("",!0),t("div",se,[e[11]||(e[11]=t("div",{class:"capture-detail-drawer__property-label"},"サイズ",-1)),t("div",re,p(g(z).formatBytes(a.capture.size)),1)]),t("div",ie,[e[13]||(e[13]=t("div",{class:"capture-detail-drawer__property-label"},"パス",-1)),t("div",ne,[t("div",oe,p(a.capture.path),1),g(m).smAndDown.value?(r(),w(f,{key:0,class:"capture-detail-drawer__fullscreen-button",variant:"tonal",size:"large",onClick:e[0]||(e[0]=y=>s.value=!0)},{default:n(()=>[l(b,{icon:"mdi-fullscreen",class:"mr-1",size:"large"}),e[12]||(e[12]=t("span",null,"全画面表示",-1))]),_:1})):u("",!0)])])])):u("",!0),t("div",de,[g(m).smAndDown.value?u("",!0):(r(),w(f,{key:0,class:"mb-4",block:"",size:"large",variant:"tonal",onClick:e[1]||(e[1]=y=>s.value=!0)},{default:n(()=>[l(b,{icon:"mdi-fullscreen",class:"mr-1",size:"large"}),e[14]||(e[14]=t("span",null,"全画面表示",-1))]),_:1})),l(f,{color:"secondary",block:"",size:"large",onClick:B},{default:n(()=>[l(b,{icon:"mdi-download",class:"mr-2"}),e[15]||(e[15]=t("span",null,"ダウンロード",-1))]),_:1}),l(f,{class:"mt-4",color:"error",block:"",size:"large",onClick:U},{default:n(()=>[l(b,{icon:"mdi-delete",class:"mr-2"}),e[16]||(e[16]=t("span",null,"削除",-1))]),_:1})])],2),s.value&&a.capture?(r(),d("div",{key:0,class:"fullscreen-viewer",onClick:e[4]||(e[4]=H(y=>s.value=!1,["self"]))},[t("img",{src:a.capture.url,class:"fullscreen-viewer__image",onClick:e[2]||(e[2]=H(()=>{},["stop"]))},null,8,ue),l(f,{class:"fullscreen-viewer__close-button",icon:"mdi-close",size:"large",variant:"flat",onClick:e[3]||(e[3]=y=>s.value=!1)})])):u("",!0),l(G,{modelValue:k.value,"onUpdate:modelValue":e[6]||(e[6]=y=>k.value=y),"max-width":"715"},{default:n(()=>[l(F,null,{default:n(()=>[l(N,{class:"d-flex justify-center pt-6 font-weight-bold"},{default:n(()=>[...e[17]||(e[17]=[T(" キャプチャを削除しますか？ ",-1)])]),_:1}),a.capture?(r(),d("div",ce,[t("div",pe,p(a.capture.name),1)])):u("",!0),l(J,{class:"pt-2 pb-0"},{default:n(()=>[t("div",me,[l(V,{icon:"fluent:info-16-regular",class:"warning-banner__icon"}),e[18]||(e[18]=t("span",{class:"warning-banner__text warning-banner__text--large"}," この操作は元に戻せません。 ",-1))])]),_:1}),l(K,{class:"pt-4 px-6 pb-6"},{default:n(()=>[l(I),l(f,{color:"text",variant:"text",onClick:e[5]||(e[5]=y=>k.value=!1)},{default:n(()=>[l(V,{icon:"fluent:dismiss-20-regular",width:"18px",height:"18px"}),e[19]||(e[19]=t("span",{class:"ml-1"},"キャンセル",-1))]),_:1}),l(f,{class:"px-3",color:"error",variant:"flat",onClick:j},{default:n(()=>[l(V,{icon:"fluent:delete-20-regular",width:"18px",height:"18px"}),e[20]||(e[20]=t("span",{class:"ml-1"},"削除",-1))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),fe=S(ve,[["__scopeId","data-v-45189fa8"]]),_e={class:"capture-list"},we={key:0,class:"capture-list__header"},ge={class:"capture-list__title"},ye={class:"capture-list__title-text"},ke={class:"capture-list__title-count"},be={class:"capture-list__actions"},he={class:"capture-list__empty-content"},xe=["innerHTML"],Ce=["innerHTML"],Ve={class:"capture-list__grid-content"},$e={key:0,class:"capture-card__title-text"},Me={key:1,class:"capture-card__title-text"},De={key:2,class:"capture-card__title-time"},Be=E({__name:"CaptureList",props:{title:{},captures:{},hideHeader:{type:Boolean,default:!1},showRefreshButton:{type:Boolean,default:!1},showMoreButton:{type:Boolean,default:!1},showEmptyMessage:{type:Boolean,default:!0},emptyIcon:{default:"fluent:image-multiple-24-regular"},emptyMessage:{default:"キャプチャはまだありません。"},emptySubMessage:{default:"視聴画面からキャプチャを撮影できます。"},isLoading:{type:Boolean,default:!1}},emits:["refresh","more","delete"],setup(a){const _=C(!1),o=C(null),x=m=>{var s;_.value&&((s=o.value)==null?void 0:s.name)===m.name?(_.value=!1,o.value=null):(o.value=m,_.value=!0)};return(m,s)=>{const v=A("Icon");return r(),d("div",_e,[a.hideHeader?u("",!0):(r(),d("div",we,[t("h2",ge,[t("span",ye,p(a.title),1),t("div",ke,[a.isLoading?(r(),w(v,{key:0,icon:"line-md:loading-twotone-loop",class:"mr-1 spin",width:"20px",height:"20px"})):(r(),d(M,{key:1},[T(p(a.captures.length)+"件",1)],64))])]),t("div",be,[a.showRefreshButton?(r(),w(f,{key:0,variant:"text",class:"capture-list__refresh-button mr-2",loading:a.isLoading,disabled:a.isLoading,onClick:s[0]||(s[0]=i=>m.$emit("refresh"))},{default:n(()=>[l(v,{icon:"fluent:arrow-sync-16-regular",width:"20px",height:"20px"}),s[4]||(s[4]=t("span",{class:"ml-1"},"更新",-1))]),_:1},8,["loading","disabled"])):u("",!0),a.showMoreButton?(r(),w(f,{key:1,variant:"text",class:"capture-list__more",onClick:s[1]||(s[1]=i=>m.$emit("more"))},{default:n(()=>[s[5]||(s[5]=t("span",{class:"text-primary"},"もっと見る",-1)),l(v,{icon:"fluent:chevron-right-12-regular",width:"18px",class:"ml-1 text-text-darken-1",style:{margin:"0px -4px"}})]),_:1})):u("",!0)])])),t("div",{class:h(["capture-list__grid",{"capture-list__grid--loading":a.isLoading,"capture-list__grid--empty":a.captures.length===0&&a.showEmptyMessage}])},[t("div",{class:h(["capture-list__empty",{"capture-list__empty--show":a.captures.length===0&&a.showEmptyMessage&&!a.isLoading}])},[t("div",he,[l(v,{class:"capture-list__empty-icon",icon:a.emptyIcon,width:"54px",height:"54px"},null,8,["icon"]),t("h2",{innerHTML:a.emptyMessage},null,8,xe),a.emptySubMessage?(r(),d("div",{key:0,class:"capture-list__empty-submessage",innerHTML:a.emptySubMessage},null,8,Ce)):u("",!0)])],2),t("div",Ve,[(r(!0),d(M,null,Q(a.captures,i=>(r(),w(F,{key:i.name,class:"capture-card",onClick:B=>x(i)},{default:n(()=>[l(D,{src:i.url,"aspect-ratio":"1.7778",class:"align-end"},{default:n(()=>[l(N,{class:"capture-card__title"},{default:n(()=>[i.program_title?(r(),d("div",$e,p(i.program_title),1)):(r(),d("div",Me,p(i.name),1)),i.time?(r(),d("div",De,p(g(Y)(i.time).format("YYYY/MM/DD HH:mm:ss")),1)):u("",!0)]),_:2},1024)]),_:2},1032,["src"])]),_:2},1032,["onClick"]))),128))])],2),l(fe,{modelValue:_.value,"onUpdate:modelValue":s[2]||(s[2]=i=>_.value=i),capture:o.value,onDelete:s[3]||(s[3]=i=>m.$emit("delete"))},null,8,["modelValue","capture"]),t("div",{class:h(["capture-list__image-viewer",{"capture-list__image-viewer--visible":_.value}])},[o.value?(r(),w(D,{key:0,src:o.value.url,cover:"",class:"capture-list__image-viewer-image"},null,8,["src"])):u("",!0)],2)])}}}),Te=S(Be,[["__scopeId","data-v-c22028e4"]]);export{Te as C};
