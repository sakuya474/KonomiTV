import{a as P,S as L}from"./swiper-BqZaw5vJ.js";import{d as R,u as V,X as s,z as D,y as N,ai as T,aj as z,c as H,a as i,b as d,f as $,n as I,h as M,af as p,ak as j,o as X,_ as A}from"./index-l7mZcvr7.js";import{B as F}from"./Breadcrumbs-BZFuG6O5.js";import{H as G,N as J}from"./Navigation-B9tp9jHO.js";import{B as K}from"./BDLibraryList-DiV54VYF.js";import{R as W}from"./RecordedProgramList-DTj-Tkfr.js";import{V as Y}from"./Videos-D0iXVmNq.js";import{u as Z}from"./BDLibraryMylistStore-DIlLO2aH.js";import"./VSpacer-DdZJeH7L.js";import"./ssrBoot-zDIWP7Ii.js";import"./BDLibrary-CgdH6yrr.js";import"./BDLibraryHistoryStore-n6sUO42x.js";import"./VMenu-DblJvnNz.js";import"./index-CrDjSE9Q.js";import"./transition-DqJDDmP2.js";import"./VAvatar-mOFXakeW.js";import"./VDivider-K1dNGbey.js";import"./dialog-transition-C3KiQuxT.js";import"./forwardRefs-DboJVnh3.js";import"./VCard-DoCWD6u_.js";import"./VDialog-CmUWZlOj.js";import"./VSelect-rJg4IKhz.js";import"./VTextField-CJf_5DNJ.js";import"./VSelectionControl-BF7B2QPK.js";import"./VChip-CSNb315t.js";import"./VPagination-BBz42OOd.js";import"./VRow-B1rb2uxW.js";import"./VCheckbox-DyjeZFF0.js";import"./VTooltip-BrwGljcS.js";const Q={class:"route-container"},ee={class:"mylist-container-wrapper"},te={class:"mylist-container"},ae={class:"tab-container"},se=R({__name:"Mylist",setup(re){const r=z(),v=j(),q=V(),m=Z(),o=s("videos"),y=s(null),_=s([]),g=s(0),u=s(!0),c=s(1),l=s("mylist_added_desc"),f=s([]),k=s(0),b=s(1),w=s("added_desc"),h=async()=>{const t=q.settings.mylist.filter(n=>n.type==="RecordedProgram").sort((n,S)=>{switch(l.value){case"mylist_added_desc":return S.created_at-n.created_at;case"mylist_added_asc":return n.created_at-S.created_at;case"recorded_desc":case"recorded_asc":return S.created_at-n.created_at;default:return 0}}).map(n=>n.id);if(t.length===0){_.value=[],g.value=0,u.value=!1;return}let e="ids";l.value==="recorded_desc"?e="desc":l.value==="recorded_asc"&&(e="asc");const a=await Y.fetchVideos(e,c.value,t);a&&(_.value=a.recorded_programs,g.value=a.total),u.value=!1},O=async t=>{c.value=t,u.value=!0,await v.replace({query:{...r.query,page:t.toString()}})},x=async t=>{l.value=t,c.value=1,u.value=!0,await v.replace({query:{...r.query,order:t,page:"1"}})};D(()=>r.query,async t=>{t.page&&(c.value=parseInt(t.page)),t.order&&(l.value=t.order),await h()},{deep:!0}),D(()=>q.settings.mylist,async()=>{o.value==="videos"&&await h()},{deep:!0});const B=async()=>{await m.fetchMylistItems();let t=m.mylist_items.map(e=>({id:e.id,bd_id:e.bd_id,title:e.title,path:e.path,added_at:e.added_at,position:e.position,duration:e.duration}));switch(w.value){case"added_asc":t.sort((e,a)=>new Date(e.added_at).getTime()-new Date(a.added_at).getTime());break;case"added_desc":default:t.sort((e,a)=>new Date(a.added_at).getTime()-new Date(e.added_at).getTime());break}f.value=t,k.value=f.value.length},C=async t=>{b.value=t},U=async t=>{w.value=t,b.value=1,await B()},E=async()=>{await B()};return N(async()=>{await T().fetchUser(),r.query.page&&(c.value=parseInt(r.query.page)),r.query.order&&(l.value=r.query.order),await h()}),D(o,async t=>{y.value&&y.value.slideTo(t==="videos"?0:1),t==="bd"&&await B(),await v.replace({query:{...r.query,tab:t}})}),(t,e)=>(X(),H("div",Q,[i(G),d("main",null,[i(J),d("div",ee,[d("div",te,[i(F,{crumbs:[{name:"ホーム",path:"/"},{name:"マイリスト",path:"/mylist/",disabled:!0}]}),d("div",ae,[d("div",{class:"tab-buttons",style:$({"--tab-length":2,"--active-tab-index":o.value==="videos"?0:1})},[d("button",{class:I(["tab-button",{active:o.value==="videos"}]),onClick:e[0]||(e[0]=a=>o.value="videos")}," 録画番組 ",2),d("button",{class:I(["tab-button",{active:o.value==="bd"}]),onClick:e[1]||(e[1]=a=>o.value="bd")}," BD ",2),e[5]||(e[5]=d("div",{class:"tab-highlight"},null,-1))],4)]),i(p(P),{class:"content-swiper","space-between":32,"auto-height":!0,"touch-start-prevent-default":!1,observer:!0,"observe-parents":!0,"initial-slide":0,onSwiper:e[3]||(e[3]=a=>y.value=a),onSlideChange:e[4]||(e[4]=a=>o.value=a.activeIndex===0?"videos":"bd")},{default:M(()=>[i(p(L),null,{default:M(()=>[i(W,{title:"録画マイリスト",programs:_.value,total:g.value,page:c.value,sortOrder:l.value,isLoading:u.value,showBackButton:!0,showEmptyMessage:!u.value,emptyIcon:"ic:round-playlist-play",emptyMessage:"あとで見たい番組を<br class='d-sm-none'>マイリストに保存できます。",emptySubMessage:"録画番組の右上にある ＋ ボタンから、<br class='d-sm-none'>番組をマイリストに追加できます。",forMylist:!0,"onUpdate:page":O,"onUpdate:sortOrder":e[2]||(e[2]=a=>x(a))},null,8,["programs","total","page","sortOrder","isLoading","showEmptyMessage"])]),_:1}),i(p(L),null,{default:M(()=>[i(K,{title:"BDマイリスト",items:f.value,total:k.value,page:b.value,sortOrder:w.value,isLoading:p(m).is_loading,showBackButton:!0,showEmptyMessage:!p(m).is_loading,emptyIcon:"ic:round-playlist-play",emptyMessage:"あとで見たいBDを<br class='d-sm-none'>マイリストに保存できます。",emptySubMessage:"BDライブラリの右下にある ＋ ボタンから、<br class='d-sm-none'>BDをマイリストに追加できます。",forMylist:!0,"onUpdate:page":C,"onUpdate:sortOrder":U,onDeleted:E},null,8,["items","total","page","sortOrder","isLoading","showEmptyMessage"])]),_:1})]),_:1})])])])]))}}),Ee=A(se,[["__scopeId","data-v-4631c2ef"]]);export{Ee as default};
